<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Superfeedr : Performance monitoring with collectd </title>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
  <meta name="google-site-verification" content="ofroHQ3qXBS1SQfblK9-U_oduGZ975Bb3i_uP13Myao" />

  <!-- Stylesheets -->
  <link href="http://yui.yahooapis.com/3.1.1/build/cssreset/reset-min.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="http://superfeedr.com/stylesheets/superfeedr.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="http://superfeedr.com/stylesheets/print.css" media="print" rel="stylesheet" type="text/css" />
  <link href="http://superfeedr.com/stylesheets/shjs/sh_nedit.min.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="http://superfeedr.com/stylesheets/thickbox.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="/css/blog.css" media="screen" rel="stylesheet" type="text/css" />
  <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/atom.xml">

 </head>

 <body class="blog">
   <div id="bg">
     <div id="wrapper">
      <div id="logo">
       <a href="http://superfeedr.com" class="home"><img alt="Superfeedr" src="http://superfeedr.com/images/superfeedr_complete.png" /></a>
     </div>
     <ul id="navigation">
      <li><a href="http://documentation.superfeedr.com" alt="RTFM">Documentation</a></li>
      <li><a href="http://superfeedr.com/about" alt="All you wanted to know. Almost">About</a></li>
    </ul>
    <div class="clear"></div>
    <div id="main_bg">
      <div id="main_top">
       <h1>Performance monitoring with collectd</h1>
     </div> <!--main_top-->

     <div id="content">
        <div id="post">
    <h2>Performance monitoring with collectd</h2>
    <div style="color:#666; font-size:0.9em; margin-bottom: 20px"><img style="float:left; margin: -2px 3px 3px 0px" src="http://www.gravatar.com/avatar/0120a25badc6b1e50f6890527dca7042?s=20" >By <a href="http://identi.ca/astro">Astro</a>, on 07 Aug 2009</div>
<p>One challenge we face when working in the Cloud is knowing <strong>when to <a href="http://blog.superfeedr.com/chef/configuration/deployment/infrastructure/scale-with-chef/">scale up</a>.</strong> That means we need some obvious figures telling us we need more resources.</p>
<p><img src="/images/collectd.png" style="float: right; margin: 5px;" alt="" /> This requires performance monitoring. From the many tools around we chose <a href="http://collectd.org/">collectd</a>. This daemon is built on a very sleek plugin infrastructure, allowing it to run with only the functionality you actually need. If you want to know how clean C looks the collectd source code is worth a look.</p>
<p>Contrary to a lot of other monitoring software, the watched hosts don&#8217;t have listening network sockets but <strong>only send <span class="caps">UDP</span> packets</strong> to a central server. It&#8217;s not necessary to control any data gathering from the outside, thus it avoids potential remote security holes.</p>
<p><img src="/images/collectd-mem.png" style="float:left; margin: 10px;" alt="" /> The primary use of collectd is <strong>monitoring of operating system resources</strong> and this is done very efficiently by its native plugins. There&#8217;s no expensive <code>fork()</code> for calling other programs. If you still need that, there&#8217;s a <a href="http://collectd.org/documentation/manpages/collectd-exec.5.shtml">exec</a> plugin for that.</p>
<p>Once you figured out which host is responsible for gathering all the data, you can configure collectd&#8217;s <a href="http://collectd.org/documentation/manpages/collectd.conf.5.shtml#plugin_network">network plugin</a> to open a listening socket for receiving other hosts&#8217; statistics.</p>
<p>To make use of the collected data you&#8217;ve got the <a href="http://collectd.org/documentation/manpages/collectd.conf.5.shtml#plugin_rrdtool">rrdtool plugin</a> which writes locally-generated or remotely-received values into the round-robin database files of the popular and proven <a href="http://oss.oetiker.ch/rrdtool/">rrdtool</a>. Pay attention to the configuration of that plugin: once you start monitoring dozens of hosts with hundreds of plugins, rrdtool will randomly write to the many <span class="caps">RRD</span> files. There are some tunable parameters and the <a href="http://collectd.org/documentation/manpages/collectd.conf.5.shtml#plugin_rrdcached">rrdcached</a> solution.</p>
<p><img src="/images/collectd-superparsr.png" style="float:right; margin: 10px;" alt="" /> You can generate your pretty graphs with the <strong>rrdgraph</strong> utility. This is being done by the included <strong>collection3</strong> <span class="caps">CGI</span> scripts. Unfortunately, this web interface is rather Web 1.0 and allows basic browsing of your graphs only. We hope for the advent of some alternative projects to allow more convenient viewing of statistics.</p>
<p>Because we do not only want to watch host resources but also the quality of our processes we have developed the <a href="http://github.com/astro/ruby-collectd/">ruby-collectd</a> library. Basically, you just define a collectd server on application startup and sprinkle your code with statements like <code>Stats.counter(:job_done).count! 1</code></p>
<p>ruby-collectd does not require collectd, so you don&#8217;t need to install it locally just for watching your own application.</p>
</div>

<blockquote>
  <p>Liked this post? <input type="button" onclick="(function(){var z=document.createElement('script');z.src='http://www.subtome.com/load.js';document.body.appendChild(z);})()" value="Follow this blog!" /> to get more or read the <a href="/archive.html">archive</a>.</p>
</blockquote>


<small class="meta">
  <a href='http://www.google.com/search?q=oss+site:blog.superfeedr.com'>oss</a>, 
  
  <a href='http://www.google.com/search?q=open-source+site:blog.superfeedr.com'>open-source</a>, 
  
  <a href='http://www.google.com/search?q=infrastructure+site:blog.superfeedr.com'>infrastructure</a>, 
  
  <a href='http://www.google.com/search?q=collectd+site:blog.superfeedr.com'>collectd</a>
  
</small>

<div id="comments">
    <h2>Comments</h2>
    <div id="disqus_thread">
    </div>
    <script type="text/javascript" src="http://disqus.com/forums/superfeedr-thoughts/embed.js"></script>
    <noscript>
        <a href="http://superfeedr-thoughts.disqus.com/?url=ref">View the discussion thread.</a>
    </noscript>
    <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

    </div> <!--content-->

    <div id="footer">
      <ul id="footer_navigation">
        <li><a href="http://documentation.superfeedr.com">Docs</a></li>
        <li><a href="https://github.com/superfeedr/documentation/issues">Support</a></li>
        <li><a href="http://blog.superfeedr.com">Blog</a></li>
        <li><a href="https://superfeedr.com/cost">Pricing</a></li>
        <li><a href="https://superfeedr.com/terms">Terms</a></li>
      </ul>
    </div>
    <div id="log" style="" ></div>
  </div> <!--main_bg-->
</div><!--wrapper-->
</div><!--bg-->
<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
  <!--//--><![CDATA[//><!--
  try {
      var pageTracker = _gat._getTracker('UA-9285763-1');
      pageTracker._setDomainName("superfeedr.com");
      pageTracker._initData();
      pageTracker._trackPageview();
  } catch(err) {}
  //--><!]]>
</script>
</body>
</html>
